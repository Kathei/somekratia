<!DOCTYPE html>
<html lang="en" ng-app="myApp">
<head>
    <meta charset="UTF-8">
    <title>Somekratia</title>
    <!--  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;signed_in=true"></script> -->

    <!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> -->
    <!--  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular-route.js"></script>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-google-maps/2.1.6/angular-google-maps.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min.js"></script>


    <!--  <script src="/static/googlemap.js"></script> -->
    <script src="/static/angular.js"></script>
    <script src="/static/angular-route.js"></script>
    <script src="/static/angular-google-maps.js"></script>
    <script src="/static/angular-simple-logger.js"></script>
    <script src="/static/lodash.js"></script>
    <script src="/static/search.js"></script>
    <script src="/static/issue.js"></script>
    <script src="/static/navigation.js"></script>
    <script src="/static/navbar_controller.js"></script>
    <script src="/static/searchresult_controller.js"></script>
    <link rel="stylesheet" type="text/css" media="screen" href="../static/style.css" />
</head>
<body>

<div class="navbar">
    <div class="nav-contents" ng-controller="navbarController">
        <a href="index.html"><img src="/static/img/somekratia_logo_small.png" class="logo"/></a>
        <ul id="mainnav">
            <li class="nav-item selected"><a href="index.html">HOME</a></li>
            <li class="nav-item"><a href=""></a>RECENT</li>
            {% verbatim %}
            <select name="categorySelect" id="category" class="nav-item" ng-model="categorySelect"
                    ng-change="categoryChanged()">
                    <option value="">KATEGORIAT</option>
                    <option ng-repeat="option in categories" value="{{option.origin_id}}">{{option.name}}</option>
            </select>
            {% endverbatim %}
        </ul>

        {% if user.is_authenticated %}
            <form class="nav-field logout-button" id="logout" action="/logout" method="post">
                {% csrf_token %}

                <button class="nav-item" type="submit">LOGOUT</button>

            </form>
        {% else %}
            <button class="nav-item login-button" ng-controller="loginShowController" ng-click="toggleShow()">LOGIN</button>
        {% endif %}

        <div class="nav-field">
            <input type="text" id="search" name="search" placeholder="Search" data-ng-model="text"/>

            <button type="submit" class="nav-item search-button" ng-controller="textSearchController" ng-click="textSearch(text)">SEARCH</button>

        </div>
    
        {% if user.is_authenticated %}
            {% verbatim %}
            <div class="nav-field nav-profile" ng-controller="profileNavController">
                <div class="user-container">
                    <img class=" user-avatar" ng-src="/user/{{ user.id }}/picture" ng-click="toggleShow()"/>
                    <span class="username">{{ user.name }}</span>
                </div>
            </div>
            {% endverbatim %}
        {% endif %}
    
    </div>

</div>

<div class="login" ng-controller="loginController" ng-show="showLogin" ng-click="toggleShow()">
    <div class="login-box" ng-click="console.log('klik')">
        <form class="" id="login" action="/login" method="post">
            {% csrf_token %}
            <!--<input type="button" id="signup" value="Sign up" />-->
            <label for="usernameinput">
                <input type="text" id="usernameinput" name="username" placeholder="Username" />
            </label>
            <label for="passwordinput">
                <input type="password" id="passwordinput" name="password" placeholder="Password" />
            </label>
            <div class="button">
                <button type="submit">Login</button>
                <button type="reset" ng-click="toggleShow()">Cancel</button>
            </div>
        </form>
    </div>
</div>
{% verbatim %}
<div id= 'map-container' ng-controller="searchController" >
    <ui-gmap-google-map center='map.center' zoom='map.zoom' events="map.mapEvents" styles="[{stylers: [{ saturation: -100 },  { visibility: 'simplified' }]}, {featureType:'water', stylers: [{color: '#94D5F7'}] }]">
        <ui-gmap-window coords="map.window.marker.coords" options="map.window.options" show="map.window.show" closeClick="map.window.closeClick" isIconVisibleOnClick="true"
                        templateUrl="templateUrl" templateParameter="content" ng-cloak>
        </ui-gmap-window>
        <ui-gmap-markers models="issueMarkers" coords="'self'" icon="'icon'" click="markerClick" events="marker.events">
        </ui-gmap-markers>

    </ui-gmap-google-map>
       </div>

    <div class="searchResultContainer" ng-controller="searchResultController" ng-show="showResults">
        <div ng-include src="'static/searchresults.html'"></div>
    </div>

    <div class="issueContainer" ng-controller="messageController" ng-show="showIssue">
        <div ng-include src="'static/issue.html'"></div>
    </div>

    <div class="profileContainer" ng-controller="profileController" ng-show="userData.showProfile">
        <div ng-include src="'static/profile.html'"></div>
    </div>

    <div id="recentMessages" ng-controller="recentController">
        <div ng-repeat="m in recentlyCommented">
            <div class="messageBubble">
                <div class="messageText">
                    Viesti: {{m.message}} - ID: {{m.issueID}}
                </div>
            </div>
        </div>
    </div>
    {% endverbatim %}

</body>
</html>
